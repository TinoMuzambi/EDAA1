---
title: "STA5092Z Assignment 1"
author: "Tino Muzambi"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Libraries

```{r, echo=FALSE}
#install.packages("tidyverse")
library(tidyverse)
```

# Read in data

```{r}
# A1 & A2
a12.2015 <- read.csv("./Data/A1_2_2015.csv") %>% as_tibble
a12.2016 <- read.csv("./Data/A1_2_2016.csv") %>% as_tibble
a12.2017 <- read.csv("./Data/A1_2_2017.csv") %>% as_tibble
a12.2018 <- read.csv("./Data/A1_2_2018.csv") %>% as_tibble
a12.2019 <- read.csv("./Data/A1_2_2019.csv") %>% as_tibble
a12.2020 <- read.csv("./Data/A1_2_2020.csv") %>% as_tibble
a12.2021 <- read.csv("./Data/A1_2_2021.csv") %>% as_tibble
a12.2022 <- read.csv("./Data/A1_2_2022.csv") %>% as_tibble

# B1
b1.2015 <- read.csv("./Data/B1_2015.csv") %>% as_tibble
b1.2016 <- read.csv("./Data/B1_2016.csv") %>% as_tibble
b1.2017 <- read.csv("./Data/B1_2017.csv") %>% as_tibble
b1.2018 <- read.csv("./Data/B1_2018.csv") %>% as_tibble
b1.2019 <- read.csv("./Data/B1_2019.csv") %>% as_tibble
b1.2020 <- read.csv("./Data/B1_2020.csv") %>% as_tibble
b1.2021 <- read.csv("./Data/B1_2021.csv") %>% as_tibble
b1.2022 <- read.csv("./Data/B1_2022.csv") %>% as_tibble

# B2
b2.2015 <- read.csv("./Data/B2_2015.csv") %>% as_tibble
b2.2016 <- read.csv("./Data/B2_2016.csv") %>% as_tibble
b2.2017 <- read.csv("./Data/B2_2017.csv") %>% as_tibble
b2.2018 <- read.csv("./Data/B2_2018.csv") %>% as_tibble
b2.2019 <- read.csv("./Data/B2_2019.csv") %>% as_tibble
b2.2020 <- read.csv("./Data/B2_2020.csv") %>% as_tibble
b2.2021 <- read.csv("./Data/B2_2021.csv") %>% as_tibble
b2.2022 <- read.csv("./Data/B2_2022.csv") %>% as_tibble
```

# Checking the data

```{r}
print("A1_2")
str(a12.2015)
str(a12.2016)
str(a12.2017)
str(a12.2018)
str(a12.2019)
str(a12.2020)
str(a12.2021)
str(a12.2022)

print("B1")
str(b1.2015)
str(b1.2016)
str(b1.2017)
str(b1.2018)
str(b1.2019)
str(b1.2020)
str(b1.2021)
str(b1.2022)

print("B2")
str(b2.2015)
str(b2.2016)
str(b2.2017)
str(b2.2018)
str(b2.2019)
str(b2.2020)
str(b2.2021)
str(b2.2022)
```
# Merge into one tibble

```{r}
# First rename StudentID variable to ID
a12.2015 <- a12.2015 %>%
  rename(ID = StudentID)
```

```{r}
undergraduate <- a12.2015
undergraduate <- bind_rows(list(undergraduate, a12.2016, a12.2017, a12.2018, a12.2019, a12.2020, a12.2021, a12.2022,
                                b1.2015, b1.2016, b1.2017, b1.2018, b1.2019, b1.2020, b1.2021, b1.2022,
                                b2.2015, b2.2016, b2.2017, b2.2018, b2.2019, b2.2020, b2.2021, b2.2022))
str(undergraduate)
```


# Look at top and bottom of data

```{r}
head(undergraduate)
tail(undergraduate)
```

# Check total number of observations

```{r}
dim(undergraduate)
```

# Create new grade column which has integers only

```{r}

# If string value in grade is an integer, convert to integer, else check if it's UP, if so, replace with 50, else replace with 0
undergraduate <- undergraduate %>%
            mutate(Num.Grade = ifelse(grepl("^[0-9]+$", Grade), as.integer(Grade), ifelse(Grade == "UP" | Grade == "PA", 50, 0)))
str(undergraduate)
```

# 1. What is the total number and percentage of students for each year who pass both the 1st and the 2nd year courses in the same year?

```{r}
pass.both <- undergraduate %>%
  group_by(Term) %>%
  mutate(Total.Number = n()) %>%
  filter(Num.Grade >= 50) %>%
  distinct(ID, .keep_all = TRUE) %>%
  summarise(Total.Pass = n(), Perc.Pass = (n() / first(Total.Number)) * 100)
```

# 2. Are there any outliers in the Grade variable? What is your definition of an outlier?

```{r}
grade.box <- undergraduate %>%
  ggplot(aes(Num.Grade)) +
  geom_boxplot()
grade.box

grade.hist <- undergraduate %>%
  ggplot(aes(Num.Grade)) +
  geom_histogram()
grade.hist

undergraduate %>%
  summary()
```

# 3. Are there any obvious clusters in the Grade variable? i.e. more marks around 50%.

```{r}
grade.density <- undergraduate %>% 
  ggplot(aes(Num.Grade)) +
  geom_density()
grade.density
```

# 4. What is the pass rate for the 1st and 2nd year courses for each year? Are there any differences between A1 and A2?

```{r}
pass.rates.first.second <- undergraduate %>%
  mutate(Course.Year = ifelse(Catalog.Nbr == "A1" | Catalog.Nbr == "A2", "First", "Second")) %>% 
  group_by(Course.Year, Term) %>% 
  mutate(Total.Number = n()) %>%
  filter(Num.Grade >= 50) %>%
  distinct(ID, .keep_all = TRUE) %>%
  summarise(Total.Pass = n(), Perc.Pass = (n() / first(Total.Number)) * 100)

pass.rates.a12 <- undergraduate %>%
  group_by(Catalog.Nbr, Term) %>% 
  filter(Catalog.Nbr == "A1" | Catalog.Nbr == "A2") %>% 
  mutate(Total.Number = n()) %>%
  filter(Num.Grade >= 50) %>%
  distinct(ID, .keep_all = TRUE) %>%
  summarise(Total.Pass = n(), Perc.Pass = (n() / first(Total.Number)) * 100)
```

# 5. How many students fail B1 even if they pass A1 or A2?

```{r}
pass.a12 <- undergraduate %>% 
  group_by(ID) %>% 
  filter(Catalog.Nbr %in% c("A1", "A2")) %>% 
  filter(Num.Grade >= 50)

fail.b1 <- undergraduate %>% 
  group_by(ID) %>% 
  filter(Catalog.Nbr == "B1" & Num.Grade < 50)

pass.a12.fail.b1 <- inner_join(pass.a12, fail.b1, by = "ID") %>% 
  nrow()
```

# 6. What would you suggest the minimum mark obtained should be from 1st year courses so that the student is able to pass B1?

```{r}

```

# 7. What would you suggest the minimum mark obtained should be for B1 so that the student is able to pass B2?

```{r}

```


# 8. Is there any hope for students with a UP (supplementary exam) for A1 or A2 to make it to the 3rd year of their studies without failing B1 and/or B2?

```{r}

```

# 9. What is the correlation between the Grades of 1st and 2nd year courses?

```{r}

```

# 10. Determine if answers for any of the above questions have been affected by Covid years? UCT has experienced other disasters, protests. Do you see any impact of these on your answers from one year to another?

```{r}

```

# 11. What kind of an informed suggestion/advice one can make to a student who is registering for A1 or A2 for the first time? What would you look at to decide from the very beginning that the student will be successful in these courses?

```{r}

```

# 12. ?

```{r}

```

# 13. ?

```{r}

```

